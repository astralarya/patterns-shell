# patterns-shell

**patterns-shell** - Design patterns for shell scripts


## Installation

You can manually copy this repository, but it is better to clone it via `git` with

>git clone https://github.com/resultsreturned/patterns-shell.git

Then you can easily get updates with

>git pull


## Patterns

### Scripts
* autoscreen - auto start a GNU screen session without inception
* pgdb - manage PostgreSQL databases
* remote - manage connections to remotes via SSH and SCP
* untar - untar and unzip archives

### Templates

You can use templates to generate custom functions.  Several scripts include
template-\* functions.  These functions take arguments and generate shell scripts
based of templates. You can save this output, analyze it, and source it, or you
can source it directly with process substitution:

>source &lt;(template-\* arg1 arg2 ... argn)

All generated functions are self documenting.  You can view this documentation with

>funcname -h

The template functions are described below:

#### pgdb
##### template-db
Generate a function to access a database  
  * $1 database name
  * $2 database user
  * $3 generated function name (default $1)

This template generates one function, where dbfunc = $3:
  * dbfunc [OPTION] [queryfile]  
    If a file is given as an argument, execute the queries in the file,  
    otherwise start a psql session connected to database.
    * -t time query or session
    * -h show help  

##### template-dbbackup
Generate a function to backup a database
  * $1 database name
  * $2 database superuser
  * $3 backup directory (absolute path, no trailing slash)
  * $4 generated function name (default ${1}backup)

This template generates one function, where dbbackupfunc = $4
  * dbbackupfunc [OPTION] [file]  
    With no arguments, generate a dated backup in the backup directory,  
    Otherwise, backup database to or restore database from file.
    * -b backup database to file
    * -r restore datase from file

#### remote
#####template-remote
Generate functions to connect to a server via SSH, and push/pull files via SCP
* $1 connection function name, as well as the base for the \*-push/pull functions
* $2 SSH/SCP server address
* $3 remote username
* $4 remote directory for SCP push/pull

There are three functions generated by this template, where connection = $1:
  * connection [OPTION] [command]  
    Connect via SSH to server  
    If a command is given, execute it remotely,  
    otherwise start an SSH session
    * -h show help
    * -X enable X11 forwarding
  * connection-push [file]  
    Push file to remote directory on server
  * connection-pull [file]  
    Pull file from remote directory on server

#### sourcedir
##### template-sourcedir
Generate statements to source all files in a directory
* $1 directory to source

NOTE: this template function does not behave correctly in process substitution
Save the output to a file and source that instead


## License

patterns-shell

Copyright (C) 2013  Mara Kim

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
